<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ERGOVIA TaskForce</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="CHROME.png" type="image/png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <!-- Added subtle animations library -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
      /* ERGOVIA-AI Theme Variables Override */
      :root {
        /* ERGOVIA-AI Brand Colors - Brown to Yellow Gradient */
        --ergovia-gradient: linear-gradient(
          180deg,
          #6b5b1a 0%,
          #8b7e2a 30%,
          #b8a548 60%,
          #ffd700 100%
        );
        --ergovia-text-gradient: linear-gradient(
          180deg,
          #c6cfdb,
          #cdd5e0,
          #f4efe8,
          #ffffff
        );
        --ergovia-navy: linear-gradient(180deg, #6b5b1a 0%, #8b7e2a 100%);
        --ergovia-gold: linear-gradient(
          180deg,
          #8b7e2a 0%,
          #b8a548 50%,
          #ffd700 100%
        );
      }

      /* Dark theme - ERGOVIA Colors */
      [data-theme="dark"] {
        --bg-primary: #0f0f0f;
        --bg-secondary: #1a1a1a;
        --bg-tertiary: #262626;
        --bg-chat: #2d2d2d;
        --text-primary: #ffd700;
        --text-secondary: #d4ac0d;
        --text-muted: #b8860b;
        --border-color: #404040;
        --border-light: #525252;
        --primary: #b8a548;
        --secondary: #ffd700;
      }

      /* Light theme - ERGOVIA Neutral Palette */
      [data-theme="light"] {
        --bg-primary: #deede5;
        --bg-secondary: #eceae5;
        --bg-tertiary: #ced6e1;
        --bg-chat: #ffffff;
        --text-primary: #2c3e50;
        --text-secondary: #5a6c7d;
        --text-muted: #8a929c;
        --border-color: #d5dbe4;
        --border-light: #e5e8ed;
        --primary: #b8a548;
        --secondary: #ffd700;
      }

      /* Template card styles with ERGOVIA theming */
      .template-card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        padding: 24px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow-sm);
        overflow: hidden;
        position: relative;
      }

      .template-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
        border-color: var(--border-light);
        background: var(--bg-tertiary);
      }

      .template-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 2px;
        background: var(--ergovia-gradient);
        transition: left 0.5s ease;
      }

      .template-card:hover::before {
        left: 0;
      }

      .card-icon {
        font-size: 2.5rem;
        margin-bottom: 16px;
        opacity: 0.9;
        transition: var(--transition);
      }

      .template-card:hover .card-icon {
        transform: scale(1.1);
        opacity: 1;
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 12px;
        line-height: 1.3;
      }

      .card-description {
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 20px;
        flex: 1;
        font-size: 0.95rem;
      }

      .card-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 16px;
      }

      .tag {
        background: var(--bg-tertiary);
        color: var(--text-muted);
        font-size: 0.8rem;
        padding: 4px 12px;
        border-radius: var(--radius-sm);
        font-weight: 500;
        border: 1px solid var(--border-color);
        transition: var(--transition);
      }

      .template-card:hover .tag {
        background: var(--bg-primary);
        color: var(--text-secondary);
      }

      .card-arrow {
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 1.2rem;
        color: var(--text-muted);
        transition: var(--transition);
        opacity: 0;
        transform: translateX(-10px);
      }

      .template-card:hover .card-arrow {
        opacity: 1;
        transform: translateX(0);
        color: var(--text-primary);
      }

      /* Media Queries for Responsiveness */
      @media (max-width: 768px) {
        .templates-grid {
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .card-title {
          font-size: 1.1rem;
        }

        .card-description {
          font-size: 0.85rem;
        }

        .tag {
          font-size: 0.7rem;
        }
      }

      @media (max-width: 576px) {
        .templates-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
    <style>
      /* Login Modal Styles */
      .login-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .login-modal.show {
        opacity: 1;
        visibility: visible;
      }

      .login-modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .login-modal-content {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-xl);
        padding: 40px;
        max-width: 400px;
        width: 100%;
        position: relative;
        box-shadow: var(--shadow-xl);
        transform: scale(0.9);
        transition: transform 0.3s ease;
      }

      .login-modal.show .login-modal-content {
        transform: scale(1);
      }

      .login-modal-close {
        position: absolute;
        top: 20px;
        right: 20px;
        background: none;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        transition: var(--transition);
      }

      .login-modal-close:hover {
        color: var(--text-primary);
      }

      .login-modal-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .login-modal-logo {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        margin-bottom: 20px;
      }

      .login-modal-logo img {
        width: 40px;
        height: 40px;
        border-radius: 8px;
      }

      .login-modal-logo span {
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--ergovia-text-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .login-modal-header h2 {
        color: var(--text-primary);
        margin-bottom: 8px;
      }

      .login-modal-header p {
        color: var(--text-secondary);
        margin: 0;
      }

      .google-login-btn {
        width: 100%;
        padding: 16px 24px;
        background: white;
        color: #1f2937;
        border: 1px solid #e5e7eb;
        border-radius: var(--radius-lg);
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        transition: var(--transition);
        margin-bottom: 20px;
      }

      .google-login-btn:hover {
        background: #f9fafb;
        transform: translateY(-1px);
      }

      .login-modal-footer {
        text-align: center;
      }

      .login-modal-footer p {
        color: var(--text-muted);
        font-size: 0.9rem;
        margin: 0;
      }

      .login-modal-footer a {
        color: var(--primary);
        text-decoration: none;
        font-weight: 600;
      }

      .login-modal-footer a:hover {
        text-decoration: underline;
      }
    </style>
    <style>
      .info-tooltip {
        position: absolute;
        top: calc(100% + -100px);
        right: calc(100% + -1000px);
        transform: none;
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        padding: 16px;
        max-width: 320px;
        min-width: 280px;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-lg);
        white-space: normal;
        pointer-events: none;
      }

      .info-tooltip.show {
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
      }

      .info-tooltip-content p {
        margin: 0 0 8px 0;
        font-size: 0.9rem;
        line-height: 1.4;
        color: var(--text-secondary);
      }

      .info-tooltip-content p:last-child {
        margin-bottom: 0;
      }

      .info-button {
        background: none;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        margin-left: 8px;
        font-size: 1rem;
        transition: var(--transition);
        position: relative;
      }

      .info-button:hover {
        color: var(--primary);
      }
    </style>
    <style>
      /* Coming Soon Overlay */
      .coming-soon-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(107, 91, 26, 0.9) 0%, rgba(139, 126, 42, 0.95) 50%, rgba(184, 165, 72, 0.9) 100%);
        color: #fff;
        font-weight: 700;
        font-size: 1.3rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 12px;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        z-index: 5;
        pointer-events: none;
        border-radius: var(--radius-lg);
        cursor: pointer;
        text-align: center;
        box-shadow: inset 0 0 50px rgba(255, 215, 0, 0.3);
      }

      .template-card:hover .coming-soon-overlay {
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
      }

      .coming-soon-overlay .overlay-icon {
        font-size: 3rem;
        margin-bottom: 8px;
        opacity: 0.9;
        animation: pulse 2s infinite;
        color: #FFD700;
        text-shadow: 0 2px 8px rgba(255, 215, 0, 0.5);
      }

      .coming-soon-overlay .overlay-text {
        font-size: 1.3rem;
        margin-bottom: 8px;
        text-shadow: 0 2px 4px rgba(107, 91, 26, 0.7);
        color: #FFD700;
        font-weight: 800;
      }

      .coming-soon-overlay .overlay-subtitle {
        font-size: 0.9rem;
        opacity: 0.9;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.95);
      }
    </style>
    <style>
      /* Subscription Modal Styles */
      .subscription-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .subscription-modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .subscription-modal-content {
        background: var(--bg-secondary);
        border: 2px solid var(--primary);
        border-radius: var(--radius-xl);
        padding: 40px;
        max-width: 500px;
        width: 100%;
        position: relative;
        box-shadow: 0 20px 60px rgba(107, 91, 26, 0.3);
        transform: scale(0.9);
        transition: transform 0.3s ease;
        text-align: center;
      }

      .subscription-modal-overlay.show .subscription-modal-content {
        transform: scale(1);
      }

      .subscription-modal-close {
        position: absolute;
        top: 20px;
        right: 20px;
        background: none;
        border: none;
        color: var(--text-muted);
        font-size: 24px;
        cursor: pointer;
        transition: var(--transition);
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .subscription-modal-close:hover {
        color: var(--text-primary);
        background: var(--bg-tertiary);
        border-radius: 50%;
      }

      .subscription-modal-logo {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        margin-bottom: 20px;
      }

      .subscription-modal-logo img {
        width: 40px;
        height: 40px;
        border-radius: 8px;
      }

      .subscription-modal-logo span {
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--ergovia-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subscription-modal-header h2 {
        color: var(--text-primary);
        margin-bottom: 12px;
        font-size: 1.5rem;
      }

      .subscription-modal-header p {
        color: var(--text-secondary);
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .subscription-pricing {
        margin-bottom: 30px;
      }

      .price-highlight {
        background: var(--ergovia-gradient);
        color: white;
        padding: 12px 24px;
        border-radius: var(--radius);
        font-weight: 700;
        font-size: 1.5rem;
        margin-bottom: 20px;
        display: inline-block;
        box-shadow: 0 4px 15px rgba(107, 91, 26, 0.3);
      }

      .subscription-benefits {
        list-style: none;
        padding: 0;
        text-align: left;
        background: var(--bg-tertiary);
        border-radius: var(--radius);
        padding: 20px;
        border: 1px solid var(--border-color);
      }

      .subscription-benefits li {
        color: var(--text-secondary);
        margin-bottom: 8px;
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .subscription-benefits li:last-child {
        margin-bottom: 0;
      }

      .subscription-form {
        margin-bottom: 20px;
      }

      .paypal-btn {
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        transition: var(--transition);
      }

      .paypal-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }

      .subscription-footer {
        color: var(--text-muted);
        font-size: 0.9rem;
        margin: 0;
      }

      @media (max-width: 480px) {
        .subscription-modal-content {
          padding: 30px 20px;
          margin: 10px;
        }

        .subscription-modal-logo span {
          font-size: 1.2rem;
        }

        .subscription-modal-header h2 {
          font-size: 1.3rem;
        }

        .price-highlight {
          font-size: 1.3rem;
          padding: 10px 20px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Enhanced top navigation bar with Back to Home button -->
    <nav class="top-nav animate__animated animate__fadeInDown">
      <div class="nav-left">
        <a href="/" class="back-btn" aria-label="Back to Home">
          <svg
            class="back-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            viewBox="0 0 24 24"
          >
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </a>
        <div class="logo-container">
          <img src="LOGO.png" alt="Prismity AI" class="logo-icon" />
          <span class="logo-text">ERGOVIA-AI Taskforce</span>
        </div>
      </div>

      <div class="nav-right">
        <button class="back-home-btn" onclick="handleDashboardClick()" title="Token Usage Dashboard">
          <span><i data-lucide="bar-chart-3"></i></span>
          <span>Dashboard</span>
        </button>

        <a href="/" class="admin-link" title="Settings">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-settings"
            viewBox="0 0 24 24"
          >
            <circle cx="12" cy="12" r="3"></circle>
            <path
              d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06A1.65 1.65 0 0 0 15 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 8.6 15a1.65 1.65 0 0 0-1.82-.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 5 8.6a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 8.6 5c.44 0 .86.17 1.18.49l.06.06a1.65 1.65 0 0 0 1.82.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06c-.32.32-.49.74-.49 1.18z"
            ></path>
          </svg>
        </a>
        <button class="theme-btn" onclick="toggleTheme()">
          <i data-lucide="moon"></i>
        </button>
      </div>
    </nav>

    <div class="container">
      <!-- TaskForce Hero Section -->
      <header class="taskforce-hero animate__animated animate__fadeInUp">
        <div class="hero-content">
          <div style="position: relative; display: inline-block">
            <h1 class="hero-title">
              ERGOVIA-AI Taskforce
              <button
                class="info-button"
                id="taskforce-info-btn"
                title="Click for more info"
              >
                <i data-lucide="info"></i>
              </button>
            </h1>
            <div class="info-tooltip" id="taskforce-info-tooltip">
              <div class="info-tooltip-content">
                <p>
                  Launch your own VA agency with Ergovia Taskforce (ETF)—your ready‑made team of AI "employees" that handle messaging, bookings, payments, reminders, and more under your brand. 
                </p>
                <p>
                  ETF to businesses in niches like gyms, clinics, rental properties, tutoring centers, and earn $50/month for each client you sign up.
                </p>
                <p>
                  Skip recruiting and training—just define your services, set your prices, and let your AI agents scale your agency 24/7.
                </p>
              </div>
            </div>
          </div>
          <p class="hero-subtitle">
            Start your AI Taskforce business — sell smart agents to real
            businesses and earn monthly income.
          </p>
          <div class="search-container">
            <div class="search-wrapper">
              <div class="search-icon"><i data-lucide="search"></i></div>
              <input
                type="text"
                id="search-input"
                class="search-input"
                placeholder="Search taskforce agents..."
                oninput="handleSearchInput()"
              />
            </div>
          </div>
        </div>
      </header>

      <!-- VIP Access Section -->
      <section class="vip-access-section" style="background: var(--bg-secondary); border: 2px solid var(--primary); border-radius: var(--radius-lg); padding: 30px; margin: 20px; text-align: center; box-shadow: var(--shadow-lg);">
        <h2 style="color: var(--text-primary); margin-bottom: 16px; font-size: 1.5rem;">🌟 Unlock VIP Access</h2>
        <p style="color: var(--text-secondary); margin-bottom: 24px; max-width: 600px; margin-left: auto; margin-right: auto;">
          Get premium access to all ERGOVIA-AI Taskforce agents and advanced features. Start earning with your AI business today!
        </p>
        <div style="margin-bottom: 20px;">
          <span style="background: var(--ergovia-gradient); color: white; padding: 8px 16px; border-radius: var(--radius); font-weight: 600; font-size: 1.1rem;">$30/month</span>
        </div>
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="display: inline-block;">
          <input type="hidden" name="cmd" value="_s-xclick" />
          <input type="hidden" name="hosted_button_id" value="VZ6W3NR3MUURQ" />
          <input type="hidden" name="currency_code" value="USD" />
          <input type="hidden" name="return" value="https://ergovia-ai.replit.app/thank-you.html" />
          <input type="hidden" name="cancel_return" value="https://ergovia-ai.replit.app/payment-cancelled.html" />
          <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_subscribe_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Subscribe" style="border-radius: var(--radius); box-shadow: var(--shadow);" />
        </form>
        <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 16px;">
          Secure payment through PayPal • Cancel anytime • Instant access
        </p>
      </section>

      <!-- Taskforce Main Content -->
      <main class="taskforce-main">
        <div class="taskforce-grid" id="taskforce-grid">
          <!-- Taskforce agents will be populated by JavaScript -->
        </div>

        <!-- No results message -->
        <div class="no-results" id="no-results" style="display: none">
          <div class="no-results-icon">🔍</div>
          <h3>No taskforce agents found</h3>
          <p>
            Try adjusting your search terms or browse all available agents.
          </p>
        </div>
      </main>
    </div>

    <script>
      // Taskforce agent data - ES5 Compatible
      var taskforceAgents = [
        {
          id: "local-contractors",
          title: "Local Contractors (Plumbers, HVAC, Electricians) Taskforce",
          description:
            "An AI office assistant for tradespeople. Manages customer inquiries, appointment booking, quote follow-ups, and connects jobs to your calendar.",
          icon: "🔧",
          tags: ["Contractors", "Scheduling", "Customer Service"],
          comingSoon: true
        },
        {
          id: "tutoring-centers",
          title: "Tutoring & Review Centers Taskforce",
          description:
            "An AI academic coordinator. Responds to parent/student inquiries, shares class schedules, follows up on payments, and helps fill class slots faster.",
          icon: "📚",
          tags: ["Education", "Scheduling", "Coordination"],
          comingSoon: true
        },
        {
          id: "dental-office",
          title: "Dental Office Taskforce",
          description:
            "An AI front desk agent. Handles appointment requests, sends reminders, reschedules visits, and answers common patient questions — automatically.",
          icon: "🦷",
          tags: ["Healthcare", "Appointments", "Patient Care"],
          comingSoon: true
        },
        {
          id: "gym-fitness",
          title: "Gym & Fitness Center Taskforce",
          description:
            "An AI membership manager. Answers new member inquiries, sends trial invites, collects feedback, and reminds leads or clients to take action.",
          icon: "🏋️",
          tags: ["Fitness", "Membership", "Customer Engagement"],
          comingSoon: true
        },
        {
          id: "massage-therapy",
          title: "Massage Therapy Clinic Taskforce",
          description:
            "An AI receptionist. Books sessions, manages reminders, handles inquiries about services, and keeps your schedule filled without lifting a finger.",
          icon: "💆",
          tags: ["Wellness", "Booking", "Customer Service"],
          comingSoon: true
        },
      ];

      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize Lucide icons AFTER DOM is loaded
        lucide.createIcons();

        // Render taskforce agents
        console.log("Rendering taskforce agents...", taskforceAgents);
        renderTaskforceAgents();

        // Force re-render after a short delay if agents are empty
        setTimeout(function () {
          const grid = document.getElementById("taskforce-grid");
          if (grid && grid.innerHTML.trim() === "") {
            console.log("Taskforce grid empty, forcing re-render...");
            renderTaskforceAgents();
          }
        }, 500);

        initializeInfoButton();
      });

      function handleSearchInput() {
        filterTaskforceAgents();
      }

      function filterTaskforceAgents() {
        var searchTerm = document
          .getElementById("search-input")
          .value.toLowerCase();
        var filteredAgents = taskforceAgents.filter(function (agent) {
          return (
            agent.title.toLowerCase().includes(searchTerm) ||
            agent.description.toLowerCase().includes(searchTerm) ||
            agent.tags.some(function (tag) {
              return tag.toLowerCase().includes(searchTerm);
            })
          );
        });
        renderTaskforceAgents(filteredAgents);
      }

      // Info button functionality
      function initializeInfoButton() {
        const infoBtn = document.getElementById("taskforce-info-btn");
        const tooltip = document.getElementById("taskforce-info-tooltip");

        if (infoBtn && tooltip) {
          // Show tooltip on hover
          infoBtn.addEventListener("mouseenter", (e) => {
            tooltip.classList.add("show");
          });

          // Hide tooltip when mouse leaves
          infoBtn.addEventListener("mouseleave", (e) => {
            // Add small delay to prevent flickering
            setTimeout(() => {
              if (!tooltip.matches(":hover") && !infoBtn.matches(":hover")) {
                tooltip.classList.remove("show");
              }
            }, 100);
          });

          // Keep tooltip visible when hovering over it
          tooltip.addEventListener("mouseenter", () => {
            tooltip.classList.add("show");
          });

          tooltip.addEventListener("mouseleave", () => {
            tooltip.classList.remove("show");
          });

          // Also support click for mobile
          infoBtn.addEventListener("click", (e) => {
            e.stopPropagation();
            tooltip.classList.toggle("show");
          });

          // Close tooltip when clicking outside
          document.addEventListener("click", (e) => {
            if (!tooltip.contains(e.target) && !infoBtn.contains(e.target)) {
              tooltip.classList.remove("show");
            }
          });
        }
      }

      // Render taskforce agents
      function renderTaskforceAgents(agentsToRender) {
        if (!agentsToRender) {
          agentsToRender = taskforceAgents;
        }

        var grid = document.getElementById("taskforce-grid");
        var noResults = document.getElementById("no-results");

        if (!grid) {
          console.error("Taskforce grid element not found");
          return;
        }

        if (agentsToRender.length === 0) {
          grid.style.display = "none";
          if (noResults) noResults.style.display = "flex";
          return;
        }

        grid.style.display = "grid";
        if (noResults) noResults.style.display = "none";

        var htmlContent = "";
        for (var i = 0; i < agentsToRender.length; i++) {
          var agent = agentsToRender[i];
          var tagsHtml = "";
          for (var j = 0; j < agent.tags.length; j++) {
            tagsHtml += '<span class="tag">' + agent.tags[j] + "</span>";
          }

          // Map agent IDs to taskforce types
          var taskforceTypeMap = {
            "local-contractors": "contractors",
            "tutoring-centers": "tutoring", 
            "dental-office": "dental",
            "gym-fitness": "gym",
            "massage-therapy": "massage"
          };
          
          var taskforceType = taskforceTypeMap[agent.id] || 'dental';
          var onboardUrl = "/taskforce/" + taskforceType + "/onboard?type=" + taskforceType;
          
          htmlContent +=
            '<div class="template-card" onclick="' + (agent.comingSoon ? 'window.location.href = "' + onboardUrl + '"' : 'selectTaskforceAgent(\'' + agent.id + '\')') + '">' +
            '<div class="card-icon">' +
            agent.icon +
            "</div>" +
            '<h3 class="card-title">' +
            agent.title +
            "</h3>" +
            '<p class="card-description">' +
            agent.description +
            "</p>" +
            '<div class="card-tags">' +
            tagsHtml +
            "</div>" +
            '<div class="card-arrow">→</div>' +
            (agent.comingSoon ?
              '<div class="coming-soon-overlay">' +
              '<i class="overlay-icon lucide-rocket"></i>' +
              '<span class="overlay-text">Get Started!</span>' +
              '<span class="overlay-subtitle">Set up your taskforce today</span>' +
              '</div>'
              : '') +
            "</div>";
        }

        grid.innerHTML = htmlContent;

        // Re-initialize Lucide icons after rendering the agents.
        lucide.createIcons();
      }

      // Select taskforce agent - allow browsing without login
      function selectTaskforceAgent(agentId) {
        localStorage.setItem("selectedTaskforceAgent", agentId);
        window.location.href = "/";
      }

      // Navigation functions
      function goBackToMain() {
        window.location.href = "/";
      }

      // Modal and Tab Functions
      function showModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.classList.add('show');
        }
      }

      function showTab(tabId) {
        // Hide all tabs
        const tabs = document.querySelectorAll('.tab-content');
        tabs.forEach(tab => tab.style.display = 'none');
        
        // Show selected tab
        const selectedTab = document.getElementById(tabId);
        if (selectedTab) {
          selectedTab.style.display = 'block';
        }
      }

      // Theme handling - ERGOVIA-AI Theme System
      function setTheme(theme) {
        document.documentElement.setAttribute("data-theme", theme);
        localStorage.setItem("theme", theme);
      }

      function toggleTheme() {
        var currentTheme = localStorage.getItem("theme") || "dark";
        var newTheme = currentTheme === "light" ? "dark" : "light";
        setTheme(newTheme);
      }

      // Set theme immediately on load to prevent flicker
      (function () {
        var savedTheme = localStorage.getItem("theme") || "dark";
        document.documentElement.setAttribute("data-theme", savedTheme);
      })();

      // Subscription Modal Functionality
      function showSubscriptionModal() {
        // Create modal overlay
        const modalOverlay = document.createElement('div');
        modalOverlay.className = 'subscription-modal-overlay';
        modalOverlay.innerHTML = `
          <div class="subscription-modal-content">
            <button class="subscription-modal-close" onclick="closeSubscriptionModal()">&times;</button>
            <div class="subscription-modal-header">
              <div class="subscription-modal-logo">
                <img src="LOGO.png" alt="ERGOVIA-AI" />
                <span>ERGOVIA-AI</span>
              </div>
              <h2>🌟 Unlock VIP Access</h2>
              <p>Get premium access to all ERGOVIA-AI Taskforce agents and start your AI business today!</p>
            </div>
            <div class="subscription-modal-body">
              <div class="subscription-pricing">
                <div class="price-highlight">$30/month</div>
                <ul class="subscription-benefits">
                  <li>✨ Access to all Taskforce agents</li>
                  <li>🚀 Premium AI business tools</li>
                  <li>💰 Earn $30/month per business client</li>
                  <li>📞 Priority customer support</li>
                  <li>🔄 Cancel anytime</li>
                </ul>
              </div>
              <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" class="subscription-form">
                <input type="hidden" name="cmd" value="_s-xclick" />
                <input type="hidden" name="hosted_button_id" value="VZ6W3NR3MUURQ" />
                <input type="hidden" name="currency_code" value="USD" />
                <input type="hidden" name="return" value="https://ergovia-ai.replit.app/thank-you.html" />
                <input type="hidden" name="cancel_return" value="https://ergovia-ai.replit.app/payment-cancelled.html" />
                <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_subscribe_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Subscribe" class="paypal-btn" />
              </form>
              <p class="subscription-footer">Secure payment through PayPal • Instant access</p>
            </div>
          </div>
        `;

        document.body.appendChild(modalOverlay);
        setTimeout(() => modalOverlay.classList.add('show'), 10);
      }

      function closeSubscriptionModal() {
        const modal = document.querySelector('.subscription-modal-overlay');
        if (modal) {
          modal.classList.remove('show');
          setTimeout(() => modal.remove(), 300);
        }
      }

      // Handle Dashboard button click - check if user is logged in
      function handleDashboardClick() {
        // Check if user is logged in - replace with your actual logic
        const isLoggedIn = false; // Replace with actual check

        if (isLoggedIn) {
          window.location.href = '/token-dashboard.html';
        } else {
          showLoginModal(); // Show login modal if not logged in
        }
      }

      // Login Modal Functions
      function showLoginModal() {
        // Remove existing modal if any
        const existingModal = document.getElementById('login-modal');
        if (existingModal) {
          existingModal.remove();
        }

        // Create modal overlay
        const modalOverlay = document.createElement('div');
        modalOverlay.id = 'login-modal';
        modalOverlay.className = 'login-modal';
        modalOverlay.innerHTML = `
          <div class="login-modal-overlay">
            <div class="login-modal-content">
              <button class="login-modal-close" onclick="hideLoginModal()">
                <i data-lucide="x"></i>
              </button>
              <div class="login-modal-header">
                <div class="login-modal-logo">
                  <img src="LOGO.png" alt="ERGOVIA-AI" />
                  <span>ERGOVIA-AI</span>
                </div>
                <h2>Please log in to continue</h2>
                <p>Sign in with your Google account to access your dashboard</p>
              </div>
              <div class="login-modal-body">
                <button class="google-login-btn" onclick="initiateGoogleLogin()">
                  <svg width="20" height="20" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                  </svg>
                  Continue with Google
                </button>
              </div>
              <div class="login-modal-footer">
                <p>Don't have an account? <a href="#" onclick="initiateGoogleLogin()">Sign up here</a></p>
              </div>
            </div>
          </div>
        `;

        document.body.appendChild(modalOverlay);
        setTimeout(() => modalOverlay.classList.add('show'), 10);

        // Re-initialize Lucide icons
        lucide.createIcons();
      }

      function hideLoginModal() {
        const modal = document.getElementById('login-modal');
        if (modal) {
          modal.classList.remove('show');
          setTimeout(() => {
            modal.remove();
          }, 300);
        }
      }

      function initiateGoogleLogin() {
        window.location.href = '/auth/google';
      }
    </script>
  </body>
</html>